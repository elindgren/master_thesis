\chapter{Introduction}

\todo{Ta med declarations of contributions (UKBiobank, Mite, Joana etc. efter Abstract).}


An area of research that has been active in recent years is the interface between neuroscience and machine learning. By combining large amounts of neuroscientific data with recent advances in machine learning, interesting insights into the inner workings of the human brain have been obtained \cite{neuro_ml, amoroso_multiplex_age, amoroso_multiplex_ad}. Another fruitful combination has come through applying the framework of graph theory in neuroscience, in which the human brain is represented as a graph, and then analysed using graph theoretic techniques \cite{chan, braph}. In this project, we have combined these approaches by applying graph-based machine learning models on neuroscientific data in order to understand the healthy ageing of, and the differences between the sexes in, the human brain. The motivation for these research questions are twofold; generally, as an effort to gain insight into how the human brain functions and potentially differs with age and sex, but also specifically since understanding the healthy ageing of the human brain may help to identify and understand unhealthy ageing, perhaps due to underlying neurological disease \cite{kaufmann}. 


\section{Neuroscientific background}

The human brain can be analysed by studying how the connections between various parts of the brain differs with sex and age. These connections can either be structural or functional. Structural connections refer to different parts of the brain being anatomically connected, whilst functional connections are slightly more abstract in that two brain regions are considered connected if their activation is correlated in time \cite{sporns}. The structural connections of the brain can be obtained through methods such as \acrshort{mri} and \acrshort{dti}, whilst functional connections are studied through functional-\acrshort{mri} (\acrshort{fmri}), \acrshort{pet}, \acrshort{eeg} and \acrshort{meg} \cite{hirsch}. Mapping these connections throughout the brain yield structural and functional brain networks, respectively. The functional networks can further be grouped together to form specialised networks. The largest of these is the default-mode network, which is primarily active when the brain experiences no external stimuli and for example considered to be responsible for mind wandering \cite{alves_dmn}.

Two types of functional brain networks derived from \acrshort{fmri} are task-specific and resting state (\acrshort{rs-fmri}) networks, depending on the state of the subject when the measurement is carried out. Task-specific networks are mapped whilst the subject is engaged in some activity, for instance memory tasks \cite{grady}. Contrary to task-specific networks, resting-state functional networks are mapped when the subject is not exposed to any external stimuli, that is, is in a resting state. In Biswal et. al. \cite{biswal}, it was observed that such resting-state functional networks are indeed affected by a subject's sex and age. Furthermore, these results were observed to be consistent across a large group of subjects, demonstrating that large data set are feasible to collect and analyse in this setting.

\section{Machine learning and graph theory in neuroscience}

One possible framework for analysing functional brain networks is graph theory. The networks are interpreted as graphs, and properties of these graphs can then be extracted using so called graph measures. This approach has previously been applied on functional brain networks with promising results. In Chan et al. \cite{chan}, graph measures where used to analyze the functional connections between various specialized brain networks, with the graph theoretical measure of segregation among the specialized networks being correlated to ageing. However, there still exists a need for more complex analysis to further understand the functioning of the human brain with regards to age and sex. For instance, it has been observed that patients suffering from neurodegenerative diseases such as dementia exhibits gaps in their estimated brain age compared to their actual age \cite{kaufmann}. Thus, if one could develop efficient methodologies for estimating brain age, such methods could be used to identify and analyze unhealthy ageing due to underlying neurodegenerative disease. 


Inspired by recent advances in machine learning, \acrlong{ann}s (\acrshort{ann}) have previously been utilized to obtain accurate and complex models for predicting sex and brain age \cite{amoroso_multiplex_age, stankeviciute, arslan}. \acrshort{ann}s typically excel at finding complex patterns in large data sets. However, classical \acrshort{ann}s are heavily dependent on the input data forming ordered tensors. This is not the case for graph structured data, since graphs by definition are node order invariant. Thus, if one wants to combine \acrshort{ann}s with the promising approach of analyzing functional brain networks as graphs, one most probably needs to turn to a class of \acrshort{ann}s known as \acrlong{gnn}s (\acrshort{gnn}) which operate directly on the graph structure. \acrlong{gcn}s (\acrshort{gcn}) are a subclass of \acrshort{gnn}s which generalize the concept of convolutions to the graph domain. \acrshort{gcn}s have shown promising results when applied to graph data in general \cite{kipf_semi_supervised, kipf_vae, wu_review}, and also specifically for the task of predicting neurodegenerative disease in human brains based on graphs derived from structural-MRI data \cite{jansson_sandstrom}. Motivated by these results, \acrshort{gcn}s applied on large \acrshort{fmri} data sets could be used to develop accurate models for predicting sex and brain age, which in turn could be analyzed to gain further insight into the functioning of the human brain.


\todo{Förtydliga att motiveringen bakom GCNs är att de utbyttjar grafstruktur}
\todo{Få in explainable AI -- från att analysera vad nätverken lär sig får vi in explainable AI.}

\todo{Få in saliency mappings etc}

\section{Aim of the project}
The aim of this thesis can be divided into two parts. The first part is to investigate how different kinds of artificial neural networks with different architectures performs when predicting sex and age from functional brain connectivity.

When this is done and a set of good performing models is established, the focus shift to analysing these models. The aim for the analysis is then to understand what the neural networks learn and how they make decisions. The end goal is then to use the information about the models to gain insight into possible specialised brain networks responsible for differences in the functional brain connectivity with age and sex.

% FÖrslag:
% The aim of the analysis is to develop  saliency mappings from the models, detailing the importance of specific functional brain networks. The end goal is to use the information from the saliency maps to gain insight into possible specialised brain networks responsible for differences in the functional brain connectivity with age and sex. 

% A saliency map is a concept from image recognition, in which importance of individual pixels is determined. The graph analogue is to determine the importance of the nodes in the graph.

\subsection{Demarcations}
Since both neuroscience and machine learning are two very large and highly active fields of research, some demarcations must be set for this thesis. Regarding the data to be analysed, one such demarcation is that only \acrshort{rs-fmri} data will be investigated, which is a demarcation both in the sense that task specific \acrshort{fmri} will not be included, but also that other forms of information such as structural connections from MRI scans not will be utilized. 

Another demarcation is that the connections defined by correlations in the \acrshort{fmri} scans are aggregated into a network with 21 connected nodes, where each node in this case does not imply a brain region, but a smaller functional network of brain regions. How this is done will be presented in more detail in section \ref{sec:fmri_to_graphs}. The reason for this is that the analysis of which functional networks in the brain that are important for separating subjects of different age and sex becomes easier. 

Regarding the machine learning, another demarcation is that this thesis only consider models that include \acrshort{gcn}s with the exception of a baseline model for comparison. There exists other types of models and architectures that could be investigated for the aim of the thesis. Other possible types of GNNs include \acrlong{gat}s (\acrshort{gat}) \cite{gat} and \acrlong{gin}s (\acrshort{gin}) \cite{gin}. More generally one could also  study the usage of other kinds of machine learning models such as \acrlong{svm}s (\acrshort{svm}) \cite{neuro_ml}.


\section{Structure of the report}
In the first chapter, theory about graphs, graph neural networks and the analysis methods will be presented. The chapter will give an overview and aims to give the reader enough to understand the methods. In the next chapter all models used in the thesis will be presented together with other necessary methods that have been developed, for instance to preprocess the data and to be able to train the networks. Thereafter, the results will be presented and will include both the evaluation of the models and the analysis of the models. Lastly, the thesis will be concluded with a chapter of discussion. 

