\chapter{Introduction}

In recent years, the interface between neuroscience and machine learning has been an active area of research. By combining large amounts of neuroscientific data with recent advances in machine learning, interesting insights into the human brain have been obtained \cite{neuro_ml, amoroso_multiplex_age, amoroso_multiplex_ad}. Another fruitful approach has been to apply the framework of graph theory in neuroscience, where the human brain is represented as a graph, and analysed using graph theoretic techniques \cite{chan, braph}. In this project, we have combined these approaches by applying graph-based machine learning models on neuroscientific data in order to understand healthy ageing, and differences between sexes, in the human brain. The motivation for this study is twofold; generally, to understand how the human brain potentially differs with age and sex, but also specifically since understanding the healthy ageing of the human brain may aid in identifying unhealthy ageing, perhaps due to underlying neurodegenerative disease \cite{kaufmann}. 

\section{Neuroscience of human brain connectivity}

The human brain can be analysed by studying how the connections between various parts of the brain differ with sex and age. These connections can either be structural or functional. Structural connections refer to different parts of the brain being anatomically connected, whilst functional connections are slightly more abstract in that two brain regions are considered connected if their activation is correlated in time \cite{sporns}. The structural connections of the brain can be obtained through methods such as \acrshort{mri} and \acrshort{dti}, whereas functional connections are studied through functional-\acrshort{mri} (\acrshort{fmri}), \acrshort{pet}, \acrshort{eeg} and \acrshort{meg} \cite{hirsch}. Mapping these connections throughout the brain yield structural and functional brain networks, respectively. The functional networks can further be grouped together to form specialised networks. The largest of these is the default-mode network, which is primarily active when the brain experiences no external stimuli and for example considered to be responsible for mind wandering \cite{alves_dmn}.

Functional brain networks can be derived from either task-specific or resting-state \acrshort{fmri} (\acrshort{rs-fmri}), depending on the state of the subject when the measurement is carried out. Task-specific networks are mapped whilst the subject is engaged in some activity, for instance memory tasks \cite{grady}. In contrast, resting-state functional networks are mapped when the subject is not exposed to any external stimuli, i.e., is in a resting state. In Biswal et. al. \cite{biswal}, it was observed that such resting-state functional networks are affected by sex and age, and that these effects where observed to be consistent across a large group of subjects.

\section{Machine learning and graph theory in neuroscience}

One possible framework for analysing functional brain networks is graph theory. The networks are interpreted as graphs, and properties of these graphs can then be extracted using graph measures. This approach has previously been applied on functional brain networks with promising results. In Chan et al. \cite{chan}, graph measures where used to analyse the functional connections between various specialised brain networks, with the graph theoretical measure of segregation among the specialised networks being correlated to ageing. However, there still exists a need for more complex analysis to further understand the functioning of the human brain with regards to age and sex. For instance, it has been observed that patients suffering from neurodegenerative diseases such as dementia exhibit gaps in their estimated brain age compared to their actual age \cite{kaufmann}. Thus, if one could develop efficient methodologies for estimating brain age, such methods could be used to identify and analyse unhealthy ageing due to underlying neurodegenerative disease. 

Inspired by recent advances in machine learning, \acrlong{ann}s (\acrshort{ann}) have previously been utilised to obtain accurate and complex models for predicting sex and brain age \cite{amoroso_multiplex_age, stankeviciute, arslan}. \acrshort{ann}s typically excel at finding complex patterns in large data sets. However, classical \acrshort{ann}s are heavily dependent on the input data forming ordered tensors. This is not the case for graph structured data, since graphs by definition are node order invariant. Thus, if one wants to combine \acrshort{ann}s with the promising approach of analysing functional brain networks as graphs, one could turn to a class of \acrshort{ann}s known as \acrlong{gnn}s (\acrshort{gnn}) which operate directly on the graph structure. \acrlong{gcn}s (\acrshort{gcn}) are a subclass of \acrshort{gnn}s which generalise the concept of convolutions to the graph domain. \acrshort{gcn}s have shown promising results when applied to graph data in general \cite{kipf_semi_supervised, kipf_vae, wu_review}, and specifically for the task of predicting neurodegenerative disease in human brains based on graphs derived from structural-MRI data \cite{jansson_sandstrom}. Motivated by these results, \acrshort{gcn}s applied on large \acrshort{fmri} data sets could be used to develop accurate models for predicting sex and brain age, which in turn could be analysed to gain further insight into the functioning of the human brain.

% \todo{Få in explainable AI -- från att analysera vad nätverken lär sig får vi in explainable AI.}

\section{Aim of the project}
The aim of this thesis is to investigate which resting-state functional brain networks are important for age and sex prediction. To this end, machine learning models based on GCNs are developed and analysed using saliency mapping techniques. A saliency map determines the importance of, for instance, individual pixels in an image or nodes in a graph, and will in this thesis reveal which functional brain networks are important for the predictions. 

\subsection{Demarcations}
Since both neuroscience and machine learning are two large and active fields of research, some demarcations must be set for this thesis. Regarding the data to be analysed, one such demarcation is that only \acrshort{rs-fmri} data will be investigated, which is a delimitation both in the sense that task-specific \acrshort{fmri} will not be included, but also that other data modalities such as \acrshort{mri} will not be utilised. Another demarcation is that in the data used in this thesis, the connections defined by correlations from the \acrshort{fmri} scans are aggregated into graphs with 21 connected nodes, where each node represents a smaller functional network of brain regions. This is a delimitation since using data with other dimensionalities could perhaps be beneificial.

A demarcation regarding the machine learning is that only models based on \acrshort{gcn}s, with the exception of a baseline model for comparison, will be considered. There exist other types of models and architectures that could be investigated for the aim of the thesis. For instance other GNNs, including \acrlong{gat}s (\acrshort{gat}) \cite{gat} and \acrlong{gin}s (\acrshort{gin}) \cite{gin}. More generally, one could also  study the usage of other kinds of machine learning models such as \acrlong{svm}s (\acrshort{svm}) \cite{neuro_ml}.


\section{Structure of the report}
The first chapter will include an overview of general graph theory and \acrlong{gcn}s, as well as the theoretical foundation for a saliency mapping technique. In the second chapter, all models used in the thesis will be presented, together with other necessary methods that have been developed, for instance to preprocess the data and be able to train the networks. Thereafter, the results will be presented, including model performance and saliency maps. Lastly, the thesis will be concluded with a discussion, conclusion and outlook. 