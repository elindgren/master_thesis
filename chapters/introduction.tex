\section{Declarations of contributions}
Ta med declarations of contributions (UKBiobank, Mite, Joana etc. efter Abstract).
TODO Flytta

\chapter{Introduction}


% ca 2 sidor

% Allm√§nt: Interesting frontier, combination of neuroscience & ML. Brain graphs, large datasets etc. Applikationer. 

An area of research that has been active in recent years is the interface between neuroscience and machine learning. By combining large amounts of neuroscientific data with recent advances in machine learning, interesting insights into the inner workings of the human brain have been obtained. One specific fruitful combination has come through the framework of graph theory, in which the human brain is represented as a graph, and then analyzed using graph theoretic techniques \cite{chan}. In this project, we have used graph-based machine learning models in order to understand the healthy ageing of, and the differences between the sexes in, the human brain. The motivation for this is twofold; generally, as an effort to gain insight into how the human brain functions, but also specifically since understanding the healthy ageing of the human brain may help us identify and understand unhealthy ageing, perhaps due to underlying neurological disease \cite{kaufmann}. 


\section{Neuroscientific background}

% Insight into healthy ageing of the brain may be used to extract new age-related biomarkers. These biomarkers can be used to identify deviations between chronological and predicted age, which could be an indicator of abnormal changes in the brain, for instance due to neurodegenerative disease \cite{multiplex}. One way to study how the brain ages is by analysing how the connections between various parts of the brain changes \cite{grady}. These connections can either be structural or functional. Structural connections refer to different parts of the brain being anatomically connected, whilst functional connections are slightly more abstract in that two brain regions are connected if their activation is correlated in time \cite{sporns}. Structural connections can be obtained through methods such as MRI and DTI, whilst functional connections are studied through e.g. functional-MRI (fMRI), PET, EEG and MEG \cite{hirsch}. Mapping these connections throughout the brain yields structural and functional brain networks, respectively. The functional networks can further be divided into several smaller specialized networks. The largest of these is the default-mode network (DMN), which is primarily active when the brain experiences no external stimuli and for example considered to be responsible for mind wandering \cite{alves_dmn}.

The human brain can be analysed by studying how the connections between various parts of the brain differs with sex and age. These connections can either be structural or functional. Structural connections refer to different parts of the brain being anatomically connected, whilst functional connections are slightly more abstract in that two brain regions are connected if their activation is correlated in time \cite{sporns}. The structural connections of the brain can be obtained through methods such as MRI and DTI, whilst functional connections are studied through functional-MRI (fMRI), PET, EEG and MEG \cite{hirsch}. Mapping these connections throughout the brain yields structural and functional brain networks, respectively. The functional networks can further be grouped together to form specialised networks. The largest of these is the default-mode network (DMN), which is primarily active when the brain experiences no external stimuli and for example considered to be responsible for mind wandering \cite{alves_dmn}.

fMRI can yield two types of functional brain networks, task-specific or resting state, depending on the state of the subject when the measurement is carried out. Task-specific networks are mapped whilst the subject is engaged with some activity, for instance memory tasks \cite{grady}. Contrary to task-specific networks, resting-state functional networks are mapped when the subject is not exposed to any external stimuli, that is, is in a resting state. In Biswal et. al. \cite{biswal}, it was observed that such resting-state functional networks are indeed affected by a subject's sex and age. Furthermore, these results were observed to be consistent across a large group of subjects, demonstrating that large data set are feasible to collect and analyse in this setting.


% Changes in functional brain networks have previously been correlated to age \cite{grady}. Specifically, age differences in brain activity have been observed during certain task-specific activities \cite{grady}. For older people, typically a larger fraction of the brain gets activated when performing a task than for younger people. This has been discussed as both the brain becoming less efficient in the use of cognitive resources and that the selectivity in what brain regions are activated for certain tasks decreases with age. However, these results aren't entirely conclusive in it's connection to ageing, mainly due to two factors. Firstly, the analysis of task-specific functional networks has yielded conflicting results between studies. Secondly, there are a lot of factors influencing ageing, which can vary from individual to individual (e.g. genetics and life experience) \cite{grady}. 

% One approach that has shown promising results in addressing the issue with task-specific functional networks is the use of resting-state functional networks. Contrary to task-related networks, resting-state networks are mapped when the patient is not exposed to external stimuli, that is, in a resting state. One technique for obtaining such resting-state networks is resting-state fMRI (R-fMRI). The situation for the second issue, being that a lot of factors influences ageing including individual deviations, can be somewhat improved by considering larger data sets \cite{grady}. In Biswal et al. \cite{biswal}, these two approaches were combined to yield correlations between resting-state functional data from a large data set and both age and sex. 

\section{Graph theory in neuroscience}

% Graph theory is one possible framework for analyzing networks, in which the network is interpreted as a graph. Properties of these graphs can then be extracted using so called graph measures. 
One possible framework for analysing functional brain networks is graph theory. The networks are interpreted as graphs, and properties of these graphs can then be extracted using so called graph measures. This approach has previously been applied on functional brain networks with promising results. In Chan et al. \cite{chan}, graph measures where used to analyze the functional connections between various specialized brain networks, with the graph theoretical measure of segregation among the specialized networks being correlated to ageing. However, there still exists a need for more complex analysis to further understand the functioning of the human brain with regards to age and sex. For instance, it has been observed that patients suffering from neurodegenerative diseases such as dementia exhibits gaps in their estimated brain age compared to their actual age \cite{kaufmann}. Thus, if one could develop efficient methodologies for estimating brain age, such methods could be used to identify and analyze unhealthy ageing due to underlying neurodegenerative disease. 


% These graph measures are examples of so called biomarkers, measureable quantitites that are indicative of some biological state of the subject \cite{strimbu}.

% However, there still exists a need for more accurate biomarkers that can be related to healthy ageing and cognitive decline \cite{multiplex}. 

Inspired by recent advances in machine learning, artifical neural networks (ANNs) have previously been utilized to obtain accurate and complex models for predicting sex and brain age \cite{multiplex}\cite{stankeviciute}\cite{arslan}. ANNs typically excel at finding complex patterns in large data sets. However, classical ANNs are heavily dependent on the input data forming ordered tensors. This is not the case for graph structured data, since graphs by definition are node order invariant. Thus, if one wants to combine ANNs with the promising approach of analyzing functional brain networks as graphs, one needs to turn to a class of ANNs known as graph neural networks (GNNs) which operate directly on the graph structure. Graph convolutional neural networks, GCNs, are a subclass of GNNs which generalize the concept of convolutions to the graph domain. GCNs have shown promising results when applied to graph data in general \cite{kipf_semi_supervised}\cite{kipf_vae}\cite{wu_review}, and also specifically for the task of predicting neurodegenerative disease in human brains based on graphs derived from structural-MRI data \cite{jansson_sandstrom}. Motivated by these results, GCNs applied on large fMRI data sets could be used to develop accurate models for predicting sex and brain age, which in turn can be analyzed to gain insight into the functioning of the human brain.

% GCNs applied on large functional data sets could build upon the results of Biswal et. al \cite{biswal} and Chan et. al \cite{chan} by deriving more complex biomarkers in order to gain more insight into the ageing brain. 

\section{Aim of the project}
The aim of this thesis can be divided into two parts. The first part is to investigate how different kinds of artificial neural networks with different architectures performs when predicting sex and age from brain connectivity.

When this is done and a set of good performing models is established, the focus shift to analysing these models. The aim is then to understand what the neural networks learn and how they make decisions. The end goal is then to use the information about the models to get insight into what the differences is between brains with different age or sex and possibly pinpoint some networks that are responsible for this differences. 


\subsection{Demarcations}
Since both analysis of the human brain from a neuroscience perspective and machine learning are two very large and highly active fields of research some demarcations must be set for this thesis. One such demarcation is that only RS-fMRI data will be used, which is a demarcation both in the sense that task specific fMRI will not be included but also that other forms of information such as structural connections from MRI scans not will be utilized. 

Another demarcation is that the connections defined by correlations in the fMRI scans are aggregated, into a network with 21 functional networks connected to each other. How this is done become clear in section \ref{sec:fmri_to_graphs}. The reason for this is that the analysis of which functional networks in the brain that is important for separating subjects with different age and sex becomes easier. 

Regarding the machine learning another demarcation is that this thesis only consider models that includes GCNs with the exception of a baseline model for comparison. Other models and archtectures are also possible both model that utilizes the graph nature of the data and models that do not.



\section{Structure of the report}
In the first chapter theory about graphs, graph neural networks and the analysis methods will be presented.
The chapter will give an overview and aims to give the reader enough to understand the methods
In the next chapter all models used in the thesis will be presented together with other necessary methods developed for instance to preprocess the data
and be able to train the networks. Thereafter the result will be presented both to evaluate the models and doing the analysis and lastly the thesis will be concluded with a chapter of discussion. 

